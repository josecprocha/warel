<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title></title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="">
  <meta property="og:type" content="">
  <meta property="og:url" content="">
  <meta property="og:image" content="">

  <link rel="manifest" href="site.webmanifest">
  <link rel="apple-touch-icon" href="icon.png">
  <!-- Place favicon.ico in the root directory -->

  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">

  <meta name="theme-color" content="#fafafa">

  <!-- cal-heatmap - https://cal-heatmap.com/ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cal-heatmap/3.6.2/cal-heatmap.css" />
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/cal-heatmap/3.6.2/cal-heatmap.min.js"></script>

  <!-- jsPDF - http://raw.githack.com/MrRio/jsPDF/master/docs/index.html -->
  <script type="text/javascript" src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
  <script>
    // import { jsPDF } from "jspdf";
    window.jsPDF = window.jspdf.jsPDF;
  </script>

</head>

<body>

  <h1>Adicione suas conversas exportadas do WhatsApp.</h1>

  <p>Como exportar conversas.</p>

  <div id="área-de-envio">
    <form class="formulário-de-envio">
      <p>Adicione os arquivos de conversas exportados do WhatsApp através do botão "Arquivo" ou arrastando e soltando na região destacada abaixo.</p>
      <input type="file" id="arquivo" multiple accept=".txt,audio/*,video/*,image/*" onchange="handleFiles(this.files)">
      <label class="button" for="arquivo">Adicione seus arquivos</label>
    </form>
  </div>

  <h1>Mapa de calor sobre os momentos em que mais trabalhou</h1>

  <div id="cal-heatmap"></div>

  <h1>Conversas durante o mês</h1>

  <h1>Baixar relatório em PDF</h1>

  <a href="javascript:geraRelatório()" id="jspdf" class="btn btn-primary">Baixar relatório em PDF</a>
  <br /><br />
  <iframe id='quadro' style="width: 80%; height: 650px; z-index: 2;"></iframe>

  <!-- Heatmap -->

  <script type="text/javascript">
    var cal = new CalHeatMap();
    cal.init({});
  </script>

  <!-- PDF -->

  <script type="text/javascript">
    function geraRelatório() {
      atualizaRelatório()
      doc.save("relatório.pdf");
    }
    function atualizaRelatório() {
      // Por padrão a exportação é em papel A4, retrato e usando milímetros como unidade de medida.
      let doc = new jsPDF(); // para "limpar" o PDF, o jeito mais fácil é criar um novo.
      doc.text("Teste", 10, 10);
      document.getElementById('quadro').src = doc.output('datauristring'); //Saída convertida em URI, mas 'bloburl' também funciona.
    }
    atualizaRelatório();
  </script>

  <script src="js/vendor/modernizr-3.11.2.min.js"></script>
  <script src="js/plugins.js"></script>
  <script src="js/main.js"></script>

  <!-- Google Analytics: change UA-XXXXX-Y to be your site's ID. -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-XXXXX-Y', 'auto'); ga('set', 'anonymizeIp', true); ga('set', 'transport', 'beacon'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async></script>
</body>

</html>
